#include <iostream>  // Подключаем библиотеку для ввода/вывода (cin, cout)
#include <vector>    // Подключаем библиотеку для использования векторов (динамических массивов)
#include <algorithm> // Подключаем библиотеку алгоритмов, где находится next_permutation

using namespace std;
int main312() {  // Главная функция программы - отсюда начинается выполнение
    int n;  // Объявляем переменную n для хранения количества чисел в перестановке
    cin >> n;  // Считываем число n из входного потока (из файла input.txt)

    vector<int> a(n);  // Создаем вектор (массив) размера n для хранения перестановки
    for (int i = 0; i < n; i++) {  // Цикл для считывания всех n чисел перестановки
        cin >> a[i];  // Считываем очередное число и сохраняем в i-ю позицию вектора
    }

    // Пытаемся получить следующую лексикографическую перестановку:
    // next_permutation возвращает true если следующая перестановка существует,
    // и false если текущая перестановка - последняя
    if (next_permutation(a.begin(), a.end())) {
        // Если следующая перестановка существует - выводим её
        for (int i = 0; i < n; i++) {  // Цикл по всем элементам перестановки
            cout << a[i] << " ";  // Выводим очередное число и пробел
        }
    }
    else {
        // Если следующей перестановки нет - выводим минимальную (первую)
        sort(a.begin(), a.end());  // Сортируем вектор по возрастанию
        for (int i = 0; i < n; i++) {  // Цикл по всем элементам перестановки
            cout << a[i] << " ";  // Выводим очередное число и пробел
        }
    }

    return 0;  // Завершаем программу с кодом 0 (успешное выполнение)
}